import {a} from './constants.js';
// https://en.wikipedia.org/wiki/Error_function#Approximation_with_elementary_functions
//
//  â€¢ approximation is given by Sergei Winitzki
//    using his "global PadÃ© approximations":
export const inverseErrorFunction = (x = 0) => {
  const {PI: Ï€, log: ln, sign, sqrt} = Math,
    //
    //       2
    //      â”€â”€â”€â”€
    //       Ï€ğ‘
    two_Ï€a = 2 / (Ï€ * a),
    //
    //        ln 1 - ğ‘¥Â²
    ln_1_xx = ln(1 - x * x),
    //
    //    2         ln 1-ğ‘¥Â²
    //   â”€â”€â”€â”€    + â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //    Ï€ğ‘           2
    sum = two_Ï€a + ln_1_xx / 2,
    //
    //  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //  â”‚â•­ 2      ln 1-ğ‘¥Â² â•®Â²   ln 1-ğ‘¥Â²
    // â”â”‚â”‚â”€â”€â”€â”€ + â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ - â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // â””â”¤â•° Ï€ğ‘        2    â•¯       ğ‘
    inner = sqrt(sum * sum - ln_1_xx / a);
  //
  //                  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  //                  â”ƒ  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  //                  â”ƒ  â”‚â•­ 2      ln 1-ğ‘¥Â² â•®Â²   ln 1-ğ‘¥Â²      2      ln 1-ğ‘¥Â²
  // erfâ»Â¹ ğ‘¥ â‰ˆ sgn ğ‘¥ â”“â”ƒ â”â”‚â”‚â”€â”€â”€â”€ + â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ - â”€â”€â”€â”€â”€â”€â”€â”€â”€  - â”€â”€â”€â”€ + â”€â”€â”€â”€â”€â”€â”€â”€â”€
  //                 â”—â”« â””â”¤â•° Ï€ğ‘        2    â•¯       ğ‘         Ï€ğ‘        2
  return sign(x) * sqrt(inner - sum);
};
